(function(){window.Locomotive={mounted_on:window.Locomotive.mounted_on,Views:{Sessions:{},Registrations:{},Passwords:{},CustomFields:{}},Flags:{}}}).call(this),function(){var t;t=Backbone.View,Backbone.View=t.extend({constructor:function(e){return this.options=e||{},t.apply(this,arguments)},replace:function(t){var e;return $(this.el).hide(),t.insertAfter($(this.el)),e=new this.constructor({el:t}),e.render(),this.remove(),e}})}.call(this),function(){String.prototype.trim=function(){return this.replace(/^\s+/g,"").replace(/\s+$/g,"")},String.prototype.repeat=function(t){for(var e=0,o="";t>e;e++)o+=this;return o},String.prototype.truncate=function(t){return this.length>t?this.slice(0,t-3)+"...":this},String.prototype.slugify=function(t){"undefined"==typeof t&&(t="_");var e=new RegExp("[^\\w\\"+t+"]","g"),o=new RegExp("[\\"+t+"]{2,}","g");return this.replace(/\s/g,t).replace(e,"").replace(o,t).toLowerCase()},window.addParameterToURL=function(t,e,o){"undefined"==typeof o&&(o=document),t=encodeURIComponent(t),e=encodeURIComponent(e);for(var i,n=o.location.search.substr(1).split("&"),r=n.length;r--;)if(i=n[r].split("="),i[0]==t){i[1]=e,n[r]=i.join("=");break}0>r&&(n[n.length]=[t,e].join("=")),o.location.search=n.join("&")},window.addJavascript=function(t,e,o){var i=t.createElement("script");i.type="text/javascript",i.src=e,o&&o.onload&&(i.onload=o.onload,delete o.onload);for(var n in o)i.setAttribute(n,o[n]);t.body.appendChild(i)},window.addStylesheet=function(t,e){var o=t.createElement("link");o.style="text/css",o.href=e,o.media="screen",o.rel="stylesheet",t.head.appendChild(o)},$.ui.dialog.prototype.overlayEl=function(){return this.overlay.$el}}(),function(){!function(){return window.remote_file_to_base64=function(t,e){var o;return o=new XMLHttpRequest,o.open("GET",t,!0),o.responseType="blob",o.onload=function(t){var o,i;return 200===this.status?(o=this.response,i=new window.FileReader,i.readAsDataURL(o),i.onloadend=function(){return e(i.result)}):e(null)},o.onerror=function(t){return e(null)},o.send()},window.resize_image=function(t,e,o){var i,n;return null==e?void o(t):(i=new FormData,i.append("image",t),i.append("format",e),n=new XMLHttpRequest,n.open("POST","/locomotive/_image_thumbnail",!0),n.onload=function(e){return o(200===this.status?this.response:t)},n.onerror=function(e){return o(t)},n.send(i))}}()}.call(this),function(){$(function(){return jQuery.fn.equalize=function(){var t,e;return t=this,e=-1,this.find_max=function(){return $(t).each(function(){var t;return t=$(this).height(),e=Math.max(t,e)})},this.apply_max=function(){return $(t).css({"min-height":e})},this.find_max(),this.apply_max(),this},$("section.main > *").equalize()})}.call(this),function(){Locomotive.notify=function(t,e){var o;return o="danger"===e?"exclamation-triangle":"success"===e?"check":"exclamation-circle",$.notify({message:t,icon:"fa fa-"+o},{type:e,placement:{from:"bottom",align:"right"}})}}.call(this),function(){var t;t=$(".content").size()>0?".content":".wrapper",$(t).size()>0&&NProgress.configure({showSpinner:!1,ease:"ease",speed:500,parent:t})}.call(this),function(){$.rails.safe_confirm=function(t){return prompt(t.question)===t.answer},$.rails.allowAction=function(t){var e,o,i,n;return i=t.data("confirm"),n=t.data("safe-confirm"),e=!1,o=null,i||n?($.rails.fire(t,"confirm")&&(i?e=$.rails.confirm(i):n&&(e=$.rails.safe_confirm(n)),o=$.rails.fire(t,"confirm:complete",[e])),e&&o):!0},$.rails.ajax=function(t){return _.isArray(t.data)?$.ajax(_.extend(t,{contentType:!1})):$.ajax(t)},$(function(){return $("body").delegate($.rails.formSubmitSelector,"ajax:beforeSend",function(t,e,o){return e.setRequestHeader("X-Flash",!0)}),$("body").delegate($.rails.formSubmitSelector,"ajax:complete",function(t,e,o){var i,n;return $(this).find("button[type=submit], input[type=submit]").button("reset"),(i=e.getResponseHeader("X-Message"))?(n="success"===o?"success":"error",Locomotive.notify(decodeURIComponent($.parseJSON(i)),n)):void 0}),$("body").delegate($.rails.formSubmitSelector,"ajax:aborted:file",function(t){return $.rails.handleRemote($(this)),!1}),$("body").delegate($.rails.formSubmitSelector,"ajax:beforeSend",function(t,e,o){return o.data=new FormData($(this)[0]),$(this).find("input[type=file]").each(function(){return o.data.append($(this).attr("name"),this.files[0])}),!0})})}.call(this),function(){window.Select2Helpers=function(){var t,e;return e=function(e){return{minimumInputLength:1,quietMillis:100,formatNoMatches:e.data("no-matches"),formatSearching:e.data("searching"),formatInputTooShort:e.data("too-short"),ajax:{url:e.data("list-url"),dataType:"json",data:function(t){return{q:t.term,page:t.page}},processResults:function(o,i){return{results:t(o,e.data("label-method"),e.data("group-by")),pagination:{more:o.length===e.data("per-page")}}}}}},t=function(t,e,o){return _.tap([],function(i){return function(n){return _.each(t,function(t){var r,s;return null==i.collection||null==i.collection.get(t._id)?(t.text=t[e],null!=o?(s=_.result(t,o),r=_.find(n,function(t){return t.text===s}),null==r&&(r={text:s,children:[]},n.push(r)),r.children.push(t)):n.push(t)):void 0})}}(this))},{build:function(t,o){var i;return o||(o={}),i=_.extend(e(t),o),t.select2(i)}}}()}.call(this),function(){!function(t){return t.commands.strike={exec:function(e,o){return t.commands.formatInline.exec(e,o,"STRIKE")},state:function(e,o){return t.commands.formatInline.state(e,o,"STRIKE",null,null)}}}(wysihtml5),function(t){return t.commands.insertFile={exec:function(t,e,o){},state:function(e,o){return t.commands.insertImage.state(e,o,"IMG")}}}(wysihtml5),function(t){var e,o;return o=function(t){var e,o,i,n;for(o="<thead><tr>",e=i=0,n=t;n>=0?n>i:i>n;e=n>=0?++i:--i)o+="<th><br></th>";return o+"</tr></thead>"},e=function(t,e){var o,i,n,r,s,a,p;for(i="<tbody>",p=n=0,s=e;s>=0?s>n:n>s;p=s>=0?++n:--n){for(i+="<tr>",o=r=0,a=t;a>=0?a>r:r>a;o=a>=0?++r:--r)i+="<td><br></td>";i+="</tr>"}return i+="</tbody>"},t.commands.createTable={exec:function(t,i,n){var r,s,a;return n=_.extend({cols:3,rows:3,class_name:"",head:!0},n),r=parseInt(n.cols,10),a=parseInt(n.rows,10),s="<table class='"+n.class_name+"'>",n.head&&(s+=o(r)),s+=e(r,a),s+="</table>",t.commands.exec("insertHTML",s)},state:function(t,e){return!1}}}(wysihtml5)}.call(this),function(){var t,e=function(t,e){function i(){this.constructor=t}for(var n in e)o.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;(t=Locomotive.Views).Shared||(t.Shared={}),Locomotive.Views.Shared.FormView=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.el=".main",o.prototype.namespace=null,o.prototype.events={"submit form":"save","ajax:aborted:required":"show_empty_form_message"},o.prototype.render=function(){return this.inputs=[],this.display_active_nav(),this.enable_hover(),this.enable_simple_image_inputs(),this.enable_file_inputs(),this.enable_array_inputs(),this.enable_toggle_inputs(),this.enable_date_inputs(),this.enable_datetime_inputs(),this.enable_text_inputs(),this.enable_rte_inputs(),this.enable_markdown_inputs(),this.enable_tags_inputs(),this.enable_document_picker_inputs(),this.enable_select_inputs(),this.enable_color_inputs(),this},o.prototype.display_active_nav=function(){var t,e;return e=document.location.toString(),e.match("#")?(t=e.split("#")[1],this.$(".nav-tabs a[href='#"+t+"']").tab("show")):void 0},o.prototype.record_active_tab=function(){var t;return $("form .nav-tabs li.active a").size()>0?(t=$("form .nav-tabs li.active a").attr("href").replace("#",""),this.$("#active_tab").val(t)):void 0},o.prototype.change_state=function(){return this.$("form button[type=submit], form input[type=submit]").button("loading")},o.prototype.reset_state=function(){return this.$("form button[type=submit], form input[type=submit]").button("reset")},o.prototype.save=function(t){return this.change_state(),this.record_active_tab()},o.prototype.show_empty_form_message=function(t){var e;return e=this.$("form").data("blank-required-fields-message"),null!=e&&Locomotive.notify(e,"error"),this.reset_state()},o.prototype.enable_hover=function(){return $(".form-group.input").hover(function(){return $(this).addClass("hovered")},function(){return $(this).removeClass("hovered")})},o.prototype.enable_simple_image_inputs=function(){var t;return t=this,this.$(".input.simple_image").each(function(){var e;return e=new Locomotive.Views.Inputs.SimpleImageView({el:$(this)}),e.render(),t.inputs.push(e)})},o.prototype.enable_file_inputs=function(){var t;return t=this,this.$(".input.file").each(function(){var e;return e=new Locomotive.Views.Inputs.FileView({el:$(this)}),e.render(),t.inputs.push(e)})},o.prototype.enable_array_inputs=function(){var t;return t=this,this.$(".input.array").each(function(){var e;return e=new Locomotive.Views.Inputs.ArrayView({el:$(this)}),e.render(),t.inputs.push(e)})},o.prototype.enable_toggle_inputs=function(){return this.$(".input.toggle input[type=checkbox]").each(function(){var t;return t=$(this),t.data("label-text",t.is(":checked")?t.data("off-text"):t.data("on-text")),t.bootstrapSwitch({onSwitchChange:function(e,o){return t.data("bootstrap-switch").labelText(o?t.data("off-text"):t.data("on-text"))}})})},o.prototype.enable_date_inputs=function(){return this.$(".input.date input[type=text]").each(function(){return $(this).datetimepicker({language:window.content_locale,pickTime:!1,widgetParent:".main",format:$(this).data("format")})})},o.prototype.enable_datetime_inputs=function(){return this.$(".input.date-time input[type=text]").each(function(){return $(this).datetimepicker({language:window.content_locale,pickTime:!0,widgetParent:".main",use24hours:!0,useseconds:!1,format:$(this).data("format")})})},o.prototype.enable_text_inputs=function(){var t;return t=this,this.$(".input.text").each(function(){var e;return e=new Locomotive.Views.Inputs.TextView({el:$(this)}),e.render(),t.inputs.push(e)})},o.prototype.enable_rte_inputs=function(){var t;return t=this,this.$(".input.rte").each(function(){var e;return e=new Locomotive.Views.Inputs.RteView({el:$(this)}),e.render(),t.inputs.push(e)})},o.prototype.enable_markdown_inputs=function(){var t;return t=this,this.$(".input.markdown").each(function(){var e;return e=new Locomotive.Views.Inputs.MarkdownView({el:$(this)}),e.render(),t.inputs.push(e)})},o.prototype.enable_color_inputs=function(){return this.$(".input.color .input-group").colorpicker({container:!1,align:"right"})},o.prototype.enable_tags_inputs=function(){return this.$(".input.tags input[type=text]").tagsinput()},o.prototype.enable_select_inputs=function(){return this.$(".input.select select:not(.disable-select2)").select2()},o.prototype.enable_document_picker_inputs=function(){var t;return t=this,this.$(".input.document_picker").each(function(){var e;return e=new Locomotive.Views.Inputs.DocumentPickerView({el:$(this)}),e.render(),t.inputs.push(e)})},o.prototype.remove=function(){return _.each(this.inputs,function(t){return t.remove()}),this.$(".input.tags input[type=text]").tagsinput("destroy"),this.$(".input.select select").select2("destroy"),this.$(".input.color .input-group").colorpicker("destroy")},o.prototype._stop_event=function(t){return t.stopPropagation()&t.preventDefault()},o}(Backbone.View)}.call(this),function(){var t,e=function(t,e){function i(){this.constructor=t}for(var n in e)o.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;(t=Locomotive.Views).Accounts||(t.Accounts={}),Locomotive.Views.Accounts.NewView=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.el=".main",o}(Locomotive.Views.Shared.FormView)}.call(this),function(){var t=function(t,o){function i(){this.constructor=t}for(var n in o)e.call(o,n)&&(t[n]=o[n]);return i.prototype=o.prototype,t.prototype=new i,t.__super__=o.prototype,t},e={}.hasOwnProperty;Locomotive.Views.SimpleView=function(e){function o(){return o.__super__.constructor.apply(this,arguments)}return t(o,e),o.prototype.el="body",o.prototype.render=function(){return this.render_flash_messages(this.options.flash),null!=this.options.view&&(this.view=new this.options.view(this.options.view_data||{}),this.view.render()),this},o.prototype.render_flash_messages=function(t){return _.each(t,function(t){return Locomotive.notify(t[1],t[0])})},o}(Backbone.View)}.call(this),function(){var t=function(t,o){function i(){this.constructor=t}for(var n in o)e.call(o,n)&&(t[n]=o[n]);return i.prototype=o.prototype,t.prototype=new i,t.__super__=o.prototype,t},e={}.hasOwnProperty;Locomotive.Views.ApplicationView=function(e){function o(){return o.__super__.constructor.apply(this,arguments)}return t(o,e),o.prototype.el="body",o.prototype.events={"click .navbar .navbar-toggle":"slide_sidebar"},o.prototype.initialize=function(){return this.header_view=new Locomotive.Views.Shared.HeaderView,this.sidebar_view=new Locomotive.Views.Shared.SidebarView,this.drawer_view=new Locomotive.Views.Shared.DrawerView},o.prototype.render=function(){return o.__super__.render.apply(this,arguments),this.sidebar_view.render(),this.drawer_view.render(),this.set_max_height(),this.automatic_max_height()},o.prototype.slide_sidebar=function(t){return $("body").toggleClass("slide-right-sidebar")},o.prototype.automatic_max_height=function(){return $(window).on("resize",function(t){return function(){var e;return e=t.set_max_height(),PubSub.publish("application_view.resize",{height:e})}}(this))},o.prototype.set_max_height=function(){var t,e;return e=$(window).height(),t=e-this.header_view.height(),this.$("> .wrapper").height(t),t},o}(Locomotive.Views.SimpleView)}.call(this),function(){var t,e=function(t,e){function i(){this.constructor=t}for(var n in e)o.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;(t=Locomotive.Views).ContentAssets||(t.ContentAssets={}),Locomotive.Views.ContentAssets.DropzoneView=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.events={"click a.upload":"open_file_browser",dragover:"hover",dragleave:"unhover",dragenter:"_stop_event",drop:"drop_files","change input[type=file]":"drop_files"},o.prototype.render=function(){return console.log("[DropzoneView] rendering"),o.__super__.render.apply(this,arguments)},o.prototype.hover=function(t){return this._stop_event(t),$(this.el).addClass("hovered")},o.prototype.unhover=function(t){return this._stop_event(t),$(this.el).removeClass("hovered")},o.prototype.show_progress=function(t){return this.$(".progress").removeClass("hide").find("> .progress-bar").width(t+"%")},o.prototype.reset_progress=function(){return setTimeout(function(t){return function(){return t.$(".progress").addClass("hide").find("> .progress-bar").width("0%")}}(this),400)},o.prototype.open_file_browser=function(t){return console.log("[DropzoneView] open_file_browser"),this._stop_event(t),this.$("form input[type=file]").trigger("click")},o.prototype.drop_files=function(t){var e;return console.log("[DropzoneView] drop_files"),this._stop_event(t)&this.unhover(t),e=new FormData,_.each(t.target.files||t.originalEvent.dataTransfer.files,function(t,o){return e.append("content_assets[][source]",t)}),this.upload_files(e)},o.prototype.upload_files=function(t){return $.ajax(this._ajax_options(t)).always(function(t){return function(){return t.reset_progress()}}(this)).fail(function(t){return function(){return t.$(".instructions").effect("shake")}}(this)).done(function(t){return function(){return console.log("uploaded"),t._refresh()}}(this))},o.prototype._refresh=function(){var t;return t=this.$("a.refresh"),t.data("remote")?t.trigger("click"):t[0].click()},o.prototype._ajax_options=function(t){return{url:$(this.el).data("url"),type:"POST",xhr:function(t){return function(){return t._build_xhr()}}(this),data:t,dataType:"json",cache:!1,contentType:!1,processData:!1}},o.prototype._build_xhr=function(){return _.tap($.ajaxSettings.xhr(),function(t){return function(e){return e.upload?e.upload.addEventListener("progress",function(e){return t.show_progress(~~(e.loaded/e.total*100))}):void 0}}(this))},o.prototype._stop_event=function(t){return t.stopPropagation()&t.preventDefault(),!0},o}(Backbone.View)}.call(this),function(){var t,e=function(t,e){function i(){this.constructor=t}for(var n in e)o.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;(t=Locomotive.Views).ContentAssets||(t.ContentAssets={}),Locomotive.Views.ContentAssets.EditImageView=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.events={"click .apply-btn":"apply","click .resize-btn":"toggle_resize_modal","click .crop-btn":"enable_crop"},o.prototype.initialize=function(){return _.bindAll(this,"change_size","apply_resizing","cancel_resizing","update_cropper_label"),o.__super__.initialize.apply(this,arguments)},o.prototype.render=function(){return this.filename=this.$(".image-container").data("filename"),this.width=parseInt(this.$(".image-container").data("width")),this.height=parseInt(this.$(".image-container").data("height")),this.ratio=this.width/this.height,this.create_cropper(),this.create_resize_popover()},o.prototype.create_cropper=function(){return this.$cropper=this.$(".image-container > img"),this.cropper_enabled=!1,this.set_cropper_height(),this.$cropper.cropper({autoCrop:!1,done:this.update_cropper_label})},o.prototype.create_resize_popover=function(){var t;return this.$link=this.$(".resize-btn"),this.$content=this.$(".resize-form").show(),this.$content.find("input").on("keyup",this.change_size),this.$content.find(".apply-resizing-btn").on("click",this.apply_resizing),this.$content.find(".cancel-resizing-btn").on("click",this.cancel_resizing),t=$(".drawer").size()>0?".drawer":".main",this.$link.popover({container:t,placement:"left",content:this.$content,html:!0,template:'<div class="popover" role="tooltip"><div class="arrow"></div><form><div class="popover-content"></div></form></div>'}),this.$link.data("bs.popover").setContent()},o.prototype.enable_crop=function(t){return this.cropper_enabled=!0,this.$cropper.cropper("clear"),this.$cropper.cropper("setDragMode","crop")},o.prototype.toggle_resize_modal=function(t){var e;return e=this.resize_modal_opened?"hide":"show",this.$link.popover(e),this.resize_modal_opened=!this.resize_modal_opened},o.prototype.change_size=function(t){var e,o,i;return e=$(t.target),i=parseInt(e.val().replace(/\D+/,"")),_.isNaN(i)?void 0:(e.val(i),"image_resize_form[width]"===e.attr("name")?(o=Math.round(i/this.ratio),this._resize_input_el("height").val(o)):(o=Math.round(i*this.ratio),this._resize_input_el("width").val(o)))},o.prototype.apply_resizing=function(t){var e,o,i;return t.stopPropagation()&t.preventDefault(),i=parseInt(this._resize_input_el("width").val()),o=parseInt(this._resize_input_el("height").val()),_.isNaN(i)||_.isNaN(o)?void 0:(e=$(t.target).button("loading"),window.resizeImageStep(this.$cropper[0],i,o).then(function(t){return function(n){return t.width=i,t.height=o,t.cropper_enabled=!0,t.$cropper.cropper("replace",n.src),t.set_cropper_height(),e.button("reset"),t.toggle_resize_modal()}}(this)))},o.prototype.cancel_resizing=function(t){return t.stopPropagation()&t.preventDefault(),this.toggle_resize_modal()},o.prototype.apply=function(t){var e,o,i,n;return t.stopPropagation()&t.preventDefault(),this.cropper_enabled?(e=$(t.target).closest(".apply-btn"),n=this.$cropper.cropper("getDataURL")||this.$cropper.attr("src"),o=window.dataURLtoBlob(n),i=new FormData,i.append("xhr",!0),i.append("content_asset[source]",o,this.filename),$.ajax({url:e.data("url"),type:"POST",data:i,processData:!1,contentType:!1,success:function(t){return function(e){return null!=t.options.on_apply_callback&&t.options.on_apply_callback(e),t.options.drawer.close()}}(this)})):void 0},o.prototype.set_cropper_height=function(){var t;return t=this.$(".edit-assets-container").height(),this.height<150?this.$(".image-container").css("max-height",2*this.height):this.height<t?this.$(".image-container").css("max-height",this.height):this.$(".image-container").css("max-height","inherit")},o.prototype.update_cropper_label=function(t){var e,o,i,n;return e=this.$(".cropper-dragger"),n=Math.round(t.width),i=Math.round(t.height),o=e.find("> .cropper-label"),0===o.size()&&(o=e.append('<span class="cropper-label"><span>').find("> .cropper-label")),o.html(n+" x "+i)},o.prototype._resize_input_el=function(t){var e;return e="image_resize_form["+t+"]",this.$content.find('input[name="'+e+'"]')},o.prototype.remove=function(){return console.log("[EditView] remove"),this.$cropper.cropper("destroy"),this.$link.popover("destroy"),o.__super__.remove.apply(this,arguments)},o}(Backbone.View)}.call(this),function(){var t,e=function(t,e){function i(){this.constructor=t}for(var n in e)o.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;(t=Locomotive.Views).ContentAssets||(t.ContentAssets={}),Locomotive.Views.ContentAssets.IndexView=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.el=".main",o.prototype.events={"click .header-row a.upload":"open_file_browser","click a.edit":"open_edit_drawer"},o.prototype.initialize=function(){return _.bindAll(this,"set_sidebar_max_height"),this.refresh_url=this.$(".content-assets").data("refresh-url"),this.dropzone=new Locomotive.Views.ContentAssets.DropzoneView({el:this.$(".dropzone")})},o.prototype.render=function(){return this.dropzone.render(),this.automatic_sidebar_max_height(),this.set_sidebar_max_height(),o.__super__.render.apply(this,arguments)},o.prototype.open_edit_drawer=function(t){var e;return console.log("[IndexView] open_edit_drawer"),t.stopPropagation()&t.preventDefault(),e=$(t.target),window.application_view.drawer_view.open(e.attr("href"),Locomotive.Views.ContentAssets.EditImageView,{on_apply_callback:function(t){return function(e){return window.location.href=t.refresh_url}}(this)})},o.prototype.hide_from_drawer=function(t){return console.log("[IndexView] hide_from_drawer"),this.options.parent_view&&0===t?this.options.parent_view.opened.picker=!1:void 0},o.prototype.open_file_browser=function(t){return this.dropzone.open_file_browser(t)},o.prototype.automatic_sidebar_max_height=function(){return $(window).on("resize",this.set_sidebar_max_height)},o.prototype.set_sidebar_max_height=function(){var t,e;return t=$(this.el).height(),e=this.$(".content-assets").height(),t>e&&(e=t),$(this.dropzone.el).height(e)},o.prototype.remove=function(){return $(window).off("resize",this.set_sidebar_max_height),this.dropzone.remove()},o}(Backbone.View)}.call(this),function(){var t,e=function(t,e){function i(){this.constructor=t}for(var n in e)o.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;(t=Locomotive.Views).ContentAssets||(t.ContentAssets={}),Locomotive.Views.ContentAssets.PickerView=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.events={"click a.select":"select","click a.edit":"open_edit_drawer"},o.prototype.ajaxified_elements=[".nav-tabs a",".pagination a",".search-bar form",".asset a.remove","a.refresh"],o.prototype.render=function(){return console.log("[PickerView] rendering"),this.ajaxify(),this.enable_dropzone(),o.__super__.render.apply(this,arguments)},o.prototype.ajaxify=function(){var t,e,o,i,n;for(o=this.ajaxified_elements,i=[],t=0,e=o.length;e>t;t++)n=o[t],i.push($(this.el).on("ajax:success",n,function(t){return function(e,o,i,n){return t.$(".updatable").html($(o).find(".updatable").html())}}(this)));return i},o.prototype.unajaxify=function(){var t,e,o,i,n;for(o=this.ajaxified_elements,i=[],t=0,e=o.length;e>t;t++)n=o[t],i.push($(this.el).off("ajax:success",n));return i},o.prototype.select=function(t){var e;return console.log("[PickerView] select"),t.stopPropagation()&t.preventDefault(),e=$(t.target),PubSub.publish("file_picker.select",{parent_view:this.options.parent_view,image:e.data("image"),title:e.attr("title"),url:e.attr("href"),filename:e.attr("href").split(/[\\\/]/).pop()})},o.prototype.open_edit_drawer=function(t){var e;return console.log("[PickerView] open_edit_drawer"),t.stopPropagation()&t.preventDefault(),e=$(t.target),window.application_view.drawer_view.open(e.attr("href"),Locomotive.Views.ContentAssets.EditImageView)},o.prototype.enable_dropzone=function(){return this.dropzone=new Locomotive.Views.ContentAssets.DropzoneView({el:this.$(".dropzone")}).render()},o.prototype.hide_from_drawer=function(t){return console.log("[PickerView] hide_from_drawer"),this.options.parent_view&&this.options.parent_view.hide_from_picker?this.options.parent_view.hide_from_picker(t):void 0},o.prototype.remove=function(){return console.log("[PickerView] remove"),this.unajaxify(),this.dropzone.remove(),o.__super__.remove.apply(this,arguments)},o}(Backbone.View)}.call(this),function(){var t,e=function(t,e){function i(){this.constructor=t}for(var n in e)o.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;(t=Locomotive.Views).ContentEntries||(t.ContentEntries={}),Locomotive.Views.ContentEntries.EditView=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o}(Locomotive.Views.Shared.FormView)}.call(this),function(){var t,e=function(t,e){function i(){this.constructor=t}for(var n in e)o.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;(t=Locomotive.Views).ContentEntries||(t.ContentEntries={}),Locomotive.Views.ContentEntries.IndexView=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.el=".main",o.prototype.initialize=function(){return this.list_view=new Locomotive.Views.Shared.ListView({el:this.$(".big-list")})},o.prototype.render=function(){return this.list_view.render()},o.prototype.remove=function(){return this.list_view.remove(),o.__super__.remove.call(this)},o}(Backbone.View)}.call(this),function(){var t,e=function(t,e){function i(){this.constructor=t}for(var n in e)o.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;(t=Locomotive.Views).ContentEntries||(t.ContentEntries={}),Locomotive.Views.ContentEntries.NewView=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o}(Locomotive.Views.Shared.FormView)}.call(this),function(){var t,e=function(t,e){function i(){this.constructor=t}for(var n in e)o.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;(t=Locomotive.Views).CurrentSite||(t.CurrentSite={}),Locomotive.Views.CurrentSite.EditView=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.el=".main",o.prototype.initialize=function(){return this.attach_events_on_private_access_attribute()},o.prototype.attach_events_on_private_access_attribute=function(){return this.$("#site_private_access").on("switchChange.bootstrapSwitch",function(t,e){var o;return o=$(".locomotive_site_password"),o.toggleClass("hide")})},o}(Locomotive.Views.Shared.FormView)}.call(this),function(){var t,e=function(t,e){function i(){this.constructor=t}for(var n in e)o.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;(t=Locomotive.Views.CustomFields).SelectOptions||(t.SelectOptions={}),Locomotive.Views.CustomFields.SelectOptions.EditView=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.el=".main",o.prototype.events={"click .buttons .edit":"start_inline_editing","click .editable .apply":"apply_inline_editing","click .editable .cancel":"cancel_inline_editing"},o.prototype.start_inline_editing=function(t){var e,o,i,n,r;return this._stop_event(t),r=$(t.target).parents(".inner-row"),n=r.find(".editable > span").addClass("hide"),i=n.next("input").removeClass("hide"),e=i.next(".btn").removeClass("hide"),o=e.next(".btn").removeClass("hide"),i.data("previous",i.val())},o.prototype.apply_inline_editing=function(t){var e,o,i,n;return this._stop_event(t),e=$(t.target).closest(".btn").addClass("hide"),o=e.next(".btn").addClass("hide"),i=e.prev("input").addClass("hide"),n=i.prev("span").html(i.val()).removeClass("hide")},o.prototype.cancel_inline_editing=function(t){var e,o,i,n;return this._stop_event(t),o=$(t.target).closest(".btn").addClass("hide"),e=o.prev(".btn").addClass("hide"),i=e.prev("input").addClass("hide"),i.val(i.data("previous")),n=i.prev("span").html(i.val()).removeClass("hide")},o.prototype.mark_as_destroyed=function(t){var e;return e=$(t.target).parents(".item").find(".mark-as-destroyed"),e.size()>0?e.val("1"):void 0},o}(Locomotive.Views.Shared.FormView)}.call(this),function(){var t,e=function(t,e){function i(){this.constructor=t}for(var n in e)o.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;(t=Locomotive.Views).Dashboard||(t.Dashboard={}),Locomotive.Views.Dashboard.ShowView=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.el=".main",o.prototype.infinite_activity_button="a[data-behavior~=load-more]",o.prototype.events={"ajax:beforeSend  a[data-behavior~=load-more]":"loading_activity_feed","ajax:success     a[data-behavior~=load-more]":"refresh_activity_feed"},o.prototype.render=function(){return o.__super__.render.apply(this,arguments),this.$(".assets img").error(function(){return $(this).parent().html($(this).attr("alt"))})},o.prototype.loading_activity_feed=function(t){return $(t.target).button("loading")},o.prototype.refresh_activity_feed=function(t,e,o,i){var n,r,s,a;return n=$(t.target).button("reset"),r=this.$(".activity-feed > li:last-child"),a=$(e),a.find(".activity-feed > li").appendTo(this.$(".activity-feed")),(s=a.find(this.infinite_activity_button)).size()>0?n.replaceWith(s):this.$(this.infinite_activity_button).hide(),$(this.el).parent().animate({scrollTop:r.offset().top+"px"},2e3)},o}(Backbone.View)}.call(this),function(){var t,e=function(t,e){function i(){this.constructor=t}for(var n in e)o.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;(t=Locomotive.Views).DevelopersDocumentation||(t.DevelopersDocumentation={}),Locomotive.Views.DevelopersDocumentation.ShowView=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.el=".main",o.prototype.render=function(){return o.__super__.render.call(this),hljs.initHighlightingOnLoad()},o}(Backbone.View)}.call(this),function(){var t,e=function(t,e){function i(){this.constructor=t}for(var n in e)o.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;(t=Locomotive.Views).EditableElements||(t.EditableElements={}),Locomotive.Views.EditableElements.EditView=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.el=".content > .inner",o.prototype.events={"click .form-group.rte label":"select_editable_text","click .form-group.text label":"select_editable_text"},o.prototype.initialize=function(){return _.bindAll(this,"highlight_form_group"),this.tokens=[PubSub.subscribe("editable_elements.highlighted_text",this.highlight_form_group)]},o.prototype.render=function(){return o.__super__.render.apply(this,arguments),$("form.edit_page").on("ajax:success",function(t){return function(e,o,i,n){return null!=t.need_reload?window.location.reload():t.refresh_inputs($(o))}}(this)),$(".info-row select[name=block]").select2().on("change",function(t){return function(e){return PubSub.publish("editable_elements.block_selected",{name:$(e.target).val()}),t.filter_elements_by($(e.target).val())}}(this)),$(".editable-elements .form-group.input.select select").select2().on("change",function(t){return function(e){return t.need_reload=!0}}(this))},o.prototype.select_editable_text=function(t){var e;return e=$(t.target).parents(".form-group").attr("id").replace("editable-text-",""),PubSub.publish("editable_elements.form_group_selected",{element_id:e})},o.prototype.highlight_form_group=function(t,e){var o,i,n,r;return o=$(this.el).find("#editable-text-"+e.element_id),0===o.size()?!1:(this.filter_elements_by(""),n=function(t){return function(){return o.clearQueue().queue(function(t){
return $(this).addClass("highlighted"),t()}).delay(200).queue(function(t){return $(this).removeClass("highlighted").find("input[type=text],textarea").trigger("highlight"),t()})}}(this),i=this.$(".scrollable"),r=o.position().top,0===r?i.animate({scrollTop:0},500,"swing",n):0>r||r>i.height()?(0>r&&(r=i.scrollTop()+r),i.animate({scrollTop:r},500,"swing",n)):n())},o.prototype.refresh_inputs=function(t){return this.inputs=_.map(this.inputs,function(e){return function(e){var o,i;return null==e.need_refresh?e:(i=$(e.el).attr("id"),o=t.find("#"+i),e.replace(o),e)}}(this))},o.prototype.filter_elements_by=function(t){return this.$(".editable-elements .form-group.input").each(function(){var e;return e=$(this),""===t||"_unknown"===t&&""===e.data("block")||e.data("block")===t?e.parent().show():e.parent().hide()})},o.prototype.remove=function(){return o.__super__.remove.apply(this,arguments),_.each(this.tokens,function(t){return PubSub.unsubscribe(t)})},o}(Locomotive.Views.Shared.FormView)}.call(this),function(){var t,e=function(t,e){function i(){this.constructor=t}for(var n in e)o.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;(t=Locomotive.Views).EditableElements||(t.EditableElements={}),Locomotive.Views.EditableElements.IframeView=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.el=".preview iframe",o.prototype.startup=!0,o.prototype.initialize=function(){return this.window=$(this.el)[0].contentWindow,$(this.el).load(function(t){return function(e){return t.on_load(e)}}(this))},o.prototype.reload=function(){return $(this.el).attr("src",this.preview_url)},o.prototype.on_load=function(t){var e;return null!=(e=this.edit_view_path())&&(this.preview_url=this.window.document.location.href,this.startup?this.startup=!1:(History.replaceState({live_editing:!0,url:this.preview_url},"",e),this.options.parent_view.replace_edit_view(e))),this.build_and_render_page_view()},o.prototype.edit_view_path=function(){var t,e,o;try{return t=$(this.window.document),t.find("meta[name=locomotive-editable-elements-path]").attr("content")}catch(o){return e=o,this.reload(),Locomotive.notify($(this.el).data("redirection-error"),"warning"),null}},o.prototype.build_and_render_page_view=function(){return null!=this.page_view&&this.page_view.remove(),this.page_view=new Locomotive.Views.EditableElements.PageView({el:$(this.window.document.body),parent_view:this,button_labels:{edit:$(this.el).data("edit-label")}}),this.page_view.render(),window.addStylesheet(this.window.document,$(this.el).data("style-path"))},o.prototype.remove=function(){return o.__super__.remove.call(this),null!=this.page_view&&this.page_view.remove(),_.each(this.tokens,function(t){return PubSub.unsubscribe(t)})},o}(Backbone.View)}.call(this),function(){var t,e=function(t,e){function i(){this.constructor=t}for(var n in e)o.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;(t=Locomotive.Views).EditableElements||(t.EditableElements={}),Locomotive.Views.EditableElements.IndexView=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.el=".wrapper",o.prototype.events={"click .content .expand-button":"expand_preview","click .content .close-button":"shrink_preview"},o.prototype.initialize=function(){var t;return t=$("body").hasClass("live-editing")?{}:{el:".main"},this.tokens=[PubSub.subscribe("editable_elements.highlighted_text",this.shrink_preview)],this.views=[new Locomotive.Views.EditableElements.EditView(t),new Locomotive.Views.EditableElements.IframeView({parent_view:this})]},o.prototype.render=function(){return o.__super__.render.call(this),_.invoke(this.views,"render")},o.prototype.expand_preview=function(t){return $("body").addClass("full-width-preview")},o.prototype.shrink_preview=function(t){return $("body").removeClass("full-width-preview")},o.prototype.replace_edit_view=function(t){return $(this.views[0].el).load(t,function(t){return function(){return t.views[0].remove(),(t.views[0]=new Locomotive.Views.EditableElements.EditView).render()}}(this))},o.prototype.remove=function(){return o.__super__.remove.call(this),_.each(this.tokens,function(t){return PubSub.unsubscribe(t)}),_.invoke(this.views,"remove")},o}(Backbone.View)}.call(this),function(){var t,e=function(t,e){function i(){this.constructor=t}for(var n in e)o.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;(t=Locomotive.Views).EditableElements||(t.EditableElements={}),Locomotive.Views.EditableElements.PageView=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.initialize=function(){return _.bindAll(this,"refresh_all","refresh_text","refresh_image","refresh_image_on_remove","scroll_to_block","scroll_to_element"),this.tokens=[PubSub.subscribe("editable_elements.block_selected",this.scroll_to_block),PubSub.subscribe("editable_elements.form_group_selected",this.scroll_to_element),PubSub.subscribe("inputs.text_changed",this.refresh_text,PubSub.subscribe("inputs.image_changed",this.refresh_image,PubSub.subscribe("inputs.image_removed",this.refresh_image_on_remove,PubSub.subscribe("pages.sorted",this.refresh_all))))],this.views=[new Locomotive.Views.EditableElements.TextHighLighterView({el:this.el,button_labels:this.options.button_labels})]},o.prototype.render=function(){return _.invoke(this.views,"render")},o.prototype.scroll_to_block=function(t,e){return this._scroll_to(this.$('span.locomotive-block-anchor[data-element-id="'+e.name+'"]'))},o.prototype.scroll_to_element=function(t,e){return this._scroll_to(this.$('span.locomotive-editable-text[data-element-id="'+e.element_id+'"]'))},o.prototype._scroll_to=function(t){return 0===t.size()?!1:$(this.el).animate({scrollTop:t.offset().top},500)},o.prototype.each_elements=function(t,e){var o,i;return o=$(t.el).parent(),i=o.find('input[name*="[id]"]').val(),e(this.$("*[data-element-id="+i+"]"),i)},o.prototype.refresh_all=function(t,e){return this.options.parent_view.reload()},o.prototype.refresh_text=function(t,e){return this.each_elements(e.view,function(t){return t.each(function(){return $(this).html(e.content)})})},o.prototype.refresh_image_on_remove=function(t,e){return e.url=$(e.view.el).parent().find('input[name*="[default_source_url]"]').val(),this.refresh_image(t,e)},o.prototype.refresh_image=function(t,e){return this.each_elements(e.view,function(t){return function(o,i){var n,r,s;return 0===o.size()&&(o=t.find_and_reference_images_identified_by_url(e.view.path,i)),0!==o.size()?(s=e.view.$(".row").data("resize-format"),n=e.view.$('input[name*="[content]"]').val(),r=e.url||n,window.resize_image(r,s,function(e){return t.replace_images(o,e)})):void 0}}(this))},o.prototype.replace_images=function(t,e){return t.each(function(){return"IMG"===this.nodeName?$(this).attr("src",e):$(this).css("background-image","url('"+e+"')")})},o.prototype.find_and_reference_images_identified_by_url=function(t,e){return this.$("*[style*='"+t+"'],img[src*='"+t+"']").attr("data-element-id",e)},o.prototype.remove=function(){return o.__super__.remove.call(this),_.each(this.tokens,function(t){return PubSub.unsubscribe(t)}),_.invoke(this.views,"remove")},o}(Backbone.View)}.call(this),function(){var t,e=function(t,e){function i(){this.constructor=t}for(var n in e)o.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;(t=Locomotive.Views).EditableElements||(t.EditableElements={}),Locomotive.Views.EditableElements.TextHighLighterView=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.events={"mouseenter .locomotive-editable-text":"show","mouseleave .locomotive-editable-text":"hide","mouseenter .locomotive-highlighter-text":"clear_hiding_timeout","mouseleave .locomotive-highlighter-text":"hide","click      #locomotive-highlighter-actions a":"edit"},o.prototype.initialize=function(){return this.build()},o.prototype.render=function(){return this.adjust_height()},o.prototype.edit=function(t){return t.stopPropagation()&t.preventDefault(),PubSub.publish("editable_elements.highlighted_text",{element_id:this.highlighted_element_id})},o.prototype.build=function(){var t,e;return t='<div id="locomotive-highlighter-actions" class="locomotive-highlighter-text"><a href="#"><i class="locomotive-fa locomotive-fa-pencil"></i>'+this.localize("edit")+"</a></div>",e='<div id="locomotive-highlighter-bar" class="locomotive-highlighter-text"></div>',$(this.el).append(t),$(this.el).append(e),this.$(".locomotive-highlighter-text").hide()},o.prototype.show=function(t){var e,o,i,n;return i=this.$(".locomotive-highlighter-text"),n=this.find_element_offset(t),this.clear_hiding_timeout(),e=i.first().show(),e.offset({top:parseInt(n.top)-32,left:parseInt(n.left)-10}),e.width(n.width).show(),o=i.last().show(),o.offset({top:parseInt(n.top),left:parseInt(n.left)-10}),o.height(n.height).show()},o.prototype.hide=function(t){return this.hiding_timeout=setTimeout(function(t){return function(){return t.$(".locomotive-highlighter-text").hide()}}(this),600)},o.prototype.clear_hiding_timeout=function(){return null!=this.hiding_timeout?clearTimeout(this.hiding_timeout):void 0},o.prototype.adjust_height=function(){return this.$(".locomotive-editable-text").each(function(){var t;return t=$(this).height(),0===t?t=$(this).css("display","block").height():void 0})},o.prototype.find_element_offset=function(t){var e;return e=$(t.target),e.hasClass("locomotive-editable-text")||(e=e.parents(".locomotive-editable-text")),this.highlighted_element_id=e.data("element-id"),_.extend(e.offset(),{height:e.height(),width:e.width()})},o.prototype.localize=function(t){return this.options.button_labels[t]},o.prototype.remove=function(){return o.__super__.remove.apply(this,arguments),null!=this.hiding_timeout?clearTimeout(this.hiding_timeout):void 0},o}(Backbone.View)}.call(this),function(){var t,e=function(t,e){function i(){this.constructor=t}for(var n in e)o.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;(t=Locomotive.Views).Inputs||(t.Inputs={}),Locomotive.Views.Inputs.ArrayView=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.events={"click a.add":"begin_add_item","keypress input[type=text]":"begin_add_item_from_enter","click a.delete":"delete_item"},o.prototype.initialize=function(){return this.$list=this.$(".list"),this.$new_input=this.$(".new-field .input"),this.$new_button=this.$(".new-field a"),this.template_url=this.$new_button.attr("href")},o.prototype.render=function(){return this.make_sortable(),this.make_selectable(),this.hide_if_empty()},o.prototype.make_sortable=function(){return this.$list.sortable({items:"> .item",handle:".draggable",axis:"y",placeholder:"sortable-placeholder",cursor:"move",start:function(t,e){return e.placeholder.html('<div class="inner">&nbsp;</div>')},update:function(t){return function(e,o){return t.$list.find('> .item:not(".hide")').each(function(t){return $(this).find(".position-in-list").val(t)})}}(this)})},o.prototype.make_selectable=function(){return"SELECT"===this.$new_input.prop("tagName")?null!=this.$new_input.data("list-url")?this.make_remote_selectable():this.make_simple_selectable():void 0},o.prototype.make_remote_selectable=function(){return Select2Helpers.build(this.$new_input),this.$new_input.on("change",function(t){return function(e){return t.begin_add_item(e)}}(this))},o.prototype.make_simple_selectable=function(){return this.$new_input.select2({templateResult:this.format_select_result,templateSelection:this.format_select_result})},o.prototype.format_select_result=function(t){var e;return null==t.id?t.text:(e=$(t.element).data("display"),$("<span>"+(null!=e?e:t.text)+"</span>"))},o.prototype.begin_add_item_from_enter=function(t){return 13===t.keyCode?this.begin_add_item(t):void 0},o.prototype.begin_add_item=function(t){var e;return t.stopPropagation()&t.preventDefault(),this.is_unique()?(e={},e[this.$new_input.attr("name")]=this.$new_input.val(),$.ajax({url:this.template_url,data:e,success:function(t){return function(e){return t.add_item(e)}}(this)})):void 0},o.prototype.add_item=function(t){return this.$list.append(t),this.showEl(this.$list),this.reset_input_field()},o.prototype.delete_item=function(t){var e,o,i;return i=$(t.target).closest("a"),"#"===i.attr("href")?(o=i.parents(".item"),e=o.find(".mark-as-destroyed"),e.size()>0?(e.val("1"),o.addClass("hide"),this.$list.find("> .item.last-child").removeClass("last-child"),this.$list.find('> .item:not(".hide"):last').addClass("last-child")):o.remove(),this.hide_if_empty()):void 0},o.prototype.hide_if_empty=function(){return 0===this.$list.find('> .item:not(".hide")').size()&&(this.hideEl(this.$list),this.$list.hasClass("new-input-disabled"))?$(this.el).find("> .form-wrapper").hide():void 0},o.prototype.is_unique=function(){return-1===_.indexOf(this.get_ids(),this.$new_input.val())},o.prototype.get_ids=function(){return _.map(this.$list.find("> .item"),function(t,e){return $(t).data("id")})},o.prototype.reset_input_field=function(){return this.$new_input.val(null).trigger("change")},o.prototype.showEl=function(t){return t.removeClass("hide")},o.prototype.hideEl=function(t){return t.addClass("hide")},o}(Backbone.View)}.call(this),function(){var t,e=function(t,e){function i(){this.constructor=t}for(var n in e)o.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;(t=Locomotive.Views).Inputs||(t.Inputs={}),Locomotive.Views.Inputs.DocumentPickerView=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.initialize=function(){return o.__super__.initialize.apply(this,arguments),this.$input=this.$("select"),this.$link=this.$("a.edit")},o.prototype.render=function(){var t;return t=this.$input.data("label"),Select2Helpers.build(this.$input,{allowClear:!0}),this.$input.data("select2").on("unselect",function(t){return function(e){return t.$link.addClass("hide"),setTimeout(function(){return t.$input.select2("close")},1)}}(this)),this.$input.on("change",function(t){return function(e){return t.$link.addClass("hide")}}(this))},o.prototype.remove=function(){return this.$input.select2("destroy"),o.__super__.remove.apply(this,arguments)},o}(Backbone.View)}.call(this),function(){var t,e=function(t,e){function i(){this.constructor=t}for(var n in e)o.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;(t=Locomotive.Views).Inputs||(t.Inputs={}),Locomotive.Views.Inputs.FileView=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.events={"change input[type=file]":"change_file","click a.choose":"begin_choose_file","click a.change":"begin_change_file","click a.content-assets":"open_content_assets_drawer","click a.cancel":"cancel_new_file","click a.delete":"mark_file_as_deleted"},o.prototype.initialize=function(){return _.bindAll(this,"use_content_asset"),this.$file=this.$("input[type=file]"),this.$remove_file=this.$("input[type=hidden].remove"),this.$remote_url=this.$("input[type=hidden].remote-url"),this.$current_file=this.$(".current-file"),this.$no_file=this.$(".no-file"),this.$new_file=this.$(".new-file"),this.$choose_btn=this.$(".buttons > .choose"),this.$change_btn=this.$(".buttons > .change"),this.$cancel_btn=this.$(".buttons .cancel"),this.$delete_btn=this.$(".buttons .delete"),this.persisted_file=this.$(".row").data("persisted-file"),this.path=$(this.el).data("path"),this.pubsub_token=PubSub.subscribe("file_picker.select",this.use_content_asset)},o.prototype.begin_change_file=function(){return this.$file.click()},o.prototype.begin_choose_file=function(){return this.$file.click()},o.prototype.open_content_assets_drawer=function(t){return t.stopPropagation()&t.preventDefault(),$(t.target).closest(".btn-group").removeClass("open"),window.application_view.drawer_view.open($(t.target).attr("href"),Locomotive.Views.ContentAssets.PickerView,{parent_view:this})},o.prototype.use_content_asset=function(t,e){var o;if(e.parent_view.cid===this.cid)return window.application_view.drawer_view.close(),o=this.absolute_url(e.url),window.remote_file_to_base64(o,function(t){return function(i){return i?(t.update_ui_on_changing_file(e.title),i=i.replace(";base64,",";"+e.filename+";base64,"),t.$remote_url.val(i),e.image?(t.$new_file.html("<img src='"+o+"' /> "+t.$new_file.html()),PubSub.publish("inputs.image_changed",{view:t,url:o})):void 0):Locomotive.notify("Unable to load the asset","error")}}(this))},o.prototype.change_file=function(t){var e,o;return e=t.target.files?t.target.files[0]:null,o=null!=e?e.name:"New file",this.update_ui_on_changing_file(o),e.type.match("image.*")?this.image_to_base_64(e,function(t){return function(o){return t.$new_file.html("<img src='"+o+"' /> "+t.$new_file.html()),PubSub.publish("inputs.image_changed",{view:t,url:o,file:e})}}(this)):void 0},o.prototype.update_ui_on_changing_file=function(t){return this.$new_file.html(t),this.showEl(this.$new_file)&&this.hideEl(this.$current_file)&&this.hideEl(this.$no_file),this.hideEl(this.$change_btn)&&this.hideEl(this.$delete_btn)&&this.hideEl(this.$choose_btn)&&this.showEl(this.$cancel_btn)},o.prototype.cancel_new_file=function(t){return this.hideEl(this.$new_file),this.$remote_url.val(""),this.$file.wrap("<form>").closest("form").get(0).reset(),this.$file.unwrap(),$(this.el).removeClass("mark-as-removed"),this.$remove_file.val("0"),this.hideEl(this.$cancel_btn),this.persisted_file?(this.showEl(this.$current_file),this.showEl(this.$change_btn)&&this.showEl(this.$delete_btn)):(this.showEl(this.$no_file),this.showEl(this.$choose_btn)),PubSub.publish("inputs.image_changed",{view:this})},o.prototype.mark_file_as_deleted=function(t){return this.$remove_file.val("1"),$(this.el).addClass("mark-as-removed"),this.hideEl(this.$change_btn)&&this.hideEl(this.$delete_btn)&&this.showEl(this.$cancel_btn),PubSub.publish("inputs.image_removed",{view:this})},o.prototype.image_to_base_64=function(t,e){var o;return o=new FileReader,o.onload=function(t){return e(t.target.result)},o.readAsDataURL(t)},o.prototype.absolute_url=function(t){var e,o;return 0===t.indexOf("http")?t:(e=location.protocol,o=e.concat("//"),o.concat(window.location.host).concat(t))},o.prototype.showEl=function(t){return t.removeClass("hide")},o.prototype.hideEl=function(t){return t.addClass("hide")},o.prototype.need_refresh=function(){return!0},o.prototype.remove=function(){return o.__super__.remove.apply(this,arguments),PubSub.unsubscribe(this.pubsub_token)},o}(Backbone.View)}.call(this),function(){var t,e=function(t,e){function i(){this.constructor=t}for(var n in e)o.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;(t=Locomotive.Views).Inputs||(t.Inputs={}),Locomotive.Views.Inputs.TextView=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.events={"change input[type=text]":"content_change","paste input[type=text]":"content_change","keyup input[type=text]":"content_change","highlight input[type=text]":"highlight","change textarea":"content_change","paste textarea":"content_change","keyup textarea":"content_change","highlight textarea":"highlight"},o.prototype.content_change=function(t){return PubSub.publish("inputs.text_changed",{view:this,content:this.text_value($(t.target))}),!0},o.prototype.text_value=function(t){return t.val()},o.prototype.highlight=function(t){return $(t.target).focus()},o}(Backbone.View)}.call(this),function(){var t=function(t,o){function i(){this.constructor=t}for(var n in o)e.call(o,n)&&(t[n]=o[n]);return i.prototype=o.prototype,t.prototype=new i,t.__super__=o.prototype,t},e={}.hasOwnProperty;Locomotive.Views.Inputs.MarkdownView=function(e){function o(){return o.__super__.constructor.apply(this,arguments)}return t(o,e),o.prototype.events=_.extend({},Locomotive.Views.Inputs.TextView.prototype.events,{"click a[data-markdown-command]":"run_command"}),o.prototype.opened_picker=!1,o.prototype.initialize=function(){return o.__super__.initialize.apply(this,arguments),_.bindAll(this,"insert_file"),this.$textarea=this.$("textarea.markdown"),this.editor=CodeMirror.fromTextArea(this.$textarea[0],{mode:"markdown",tabMode:"indent",lineWrapping:!0}),this.pubsub_token=PubSub.subscribe("file_picker.select",this.insert_file)},o.prototype.run_command=function(t){var e,o;switch(e=$(t.target).closest("a"),o=e.data("markdown-command")){case"bold":this.apply_bold();break;case"italic":this.apply_italic();break;case"insertFile":this.open_file_picker(e.data("url"));break;default:return void console.log("[Markdown input] command not implemented: "+o)}return this.content_change_with_markdown()},o.prototype.apply_bold=function(){var t;return t=this.editor.getSelection(),null!=t&&t.length>0||(t="Some text"),this.editor.replaceSelection("**"+t+"**")},o.prototype.apply_italic=function(){var t;return t=this.editor.getSelection(),null!=t&&t.length>0||(t="Some text"),this.editor.replaceSelection("*"+t+"*")},o.prototype.insert_file=function(t,e){var o;if(e.parent_view.cid===this.cid)return o=this.editor.getSelection(),(null==o||0===o.length)&&(o=e.title),e.image?this.editor.replaceSelection(" !["+o+"]("+e.url+") "):this.editor.replaceSelection(" ["+o+"]("+e.url+") "),this.content_change_with_markdown(),this.hide_file_picker()},o.prototype.content_change_with_markdown=function(){var t;return t=$.Event("change",{target:this.$textarea}),this.content_change(t)},o.prototype.text_value=function(t){return kramed(this.editor.getValue())},o.prototype.open_file_picker=function(t){return this.opened_picker===!1?(window.application_view.drawer_view.open(t,Locomotive.Views.ContentAssets.PickerView,{parent_view:this}),this.opened_picker=!0):void 0},o.prototype.hide_file_picker=function(){return window.application_view.drawer_view.close(),this.opened_picker=!1},o.prototype.remove=function(){return PubSub.unsubscribe(this.pubsub_token),o.__super__.remove.apply(this,arguments)},o}(Locomotive.Views.Inputs.TextView)}.call(this),function(){var t,e=function(t,e){function i(){this.constructor=t}for(var n in e)o.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;(t=Locomotive.Views.Inputs).Rte||(t.Rte={}),Locomotive.Views.Inputs.Rte.EditTableView=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.initialize=function(){return _.bindAll(this,"hide"),this.$link=this.$("a[data-wysihtml5-hiddentools=table]"),this.$content=this.$link.next(".table-dialog-content"),this.editor=this.options.editor},o.prototype.render=function(){return this.create_popover(),this.attach_events()},o.prototype.create_popover=function(){return this.$link.popover({placement:"bottom",content:this.$content.html(),html:!0,title:void 0})},o.prototype.attach_events=function(){return this.editor.on("tableunselect:composer",this.hide)},o.prototype.detach_events=function(){return this.editor.stopObserving("tableselect:composer",this.hide)},o.prototype.hide=function(){return this.$link.popover("hide")},o.prototype.remove=function(){return this.$link.popover("destroy"),this.$(".popover").remove()},o}(Backbone.View)}.call(this),function(){var t,e=function(t,e){function i(){this.constructor=t}for(var n in e)o.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;(t=Locomotive.Views.Inputs).Rte||(t.Rte={}),Locomotive.Views.Inputs.Rte.FileView=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.opened={popover:!1,picker:!1},o.prototype.container={dataset:[]},o.prototype.initialize=function(){return _.bindAll(this,"change_image","insert_file","hide"),this.$link=this.$("a[data-wysihtml5-command=insertFile]"),this.editor=this.options.editor,this.$popover=this.$link.next(".image-dialog-content"),this.pubsub_token=PubSub.subscribe("file_picker.select",this.insert_file)},o.prototype.render=function(){return this.attach_editor(),this.create_popover()},o.prototype.attach_editor=function(){var t;return t=this.editor.toolbar.commandMapping["insertFile:null"],t.dialog=this},o.prototype.create_popover=function(){return this.$popover.show(),this.$link.popover({container:".main",placement:"left",content:this.$popover,html:!0,template:'<div class="popover" role="tooltip"><div class="arrow"></div><form class="simple_form"><div class="popover-content"></div></form></div>'}),this.$link.data("bs.popover").setContent(),this.attach_popover_events()},o.prototype.attach_popover_events=function(){return this.$popover.parents("form").on("click",".apply",this.change_image),this.$popover.on("click",".apply",this.change_image),this.$popover.on("click",".cancel",this.hide)},o.prototype.detach_popover_events=function(){return this.$popover.parents("form").on("click",".apply",this.change_image),this.$popover.on("click",".apply",this.change_image),this.$popover.on("click",".cancel",this.hide)},o.prototype.change_image=function(t){return this.editor.composer.commands.exec("insertImage",{src:this._input_el("src").val(),"class":this._input_el("alignment","select").val(),title:this._input_el("title").val()}),this.hide()},o.prototype.insert_file=function(t,e){var o;if(e.parent_view.cid===this.cid)return e.image?this.editor.composer.commands.exec("insertImage",{src:e.url,title:e.title}):(o="<a href='"+e.url+"' title='"+e.title+"'>"+e.title+"</a>",this.editor.composer.commands.exec("insertHTML",o)),this.editor.toolbar._preventInstantFocus(),this.hide()},o.prototype.show=function(t){var e;return this.editor.focus(),t===!1?(this.hide_popover(),this.show_picker()):(e=$(t),this._input_el("src").val(e.attr("src")),this._input_el("alignment","select").val(e.attr("class")),this._input_el("title").val(e.attr("title")),this.show_popover())},o.prototype.show_picker=function(){return this.opened.picker===!1?(window.application_view.drawer_view.open(this.$link.data("url"),Locomotive.Views.ContentAssets.PickerView,{parent_view:this}),this.opened.picker=!0):void 0},o.prototype.show_popover=function(){return this.opened.popover===!1?(this.$link.popover("show"),this.opened.popover=!0):void 0},o.prototype.hide=function(){return this.opened.picker?this.hide_picker():this.opened.popover?this.hide_popover():void 0},o.prototype.hide_picker=function(){return window.application_view.drawer_view.close(),this.opened.picker=!1},o.prototype.hide_from_picker=function(t){return 0===t?this.opened.picker=!1:void 0},o.prototype.hide_popover=function(){return this.$link.popover("hide"),this.opened.popover=!1},o.prototype._input_el=function(t,e){var o;return e||(e="input"),o="rte_input_image_form["+t+"]",this.$popover.find(e+'[name="'+o+'"]')},o.prototype.remove=function(){return this.detach_popover_events(),this.$link.popover("destroy"),this.$(".popover").remove(),PubSub.unsubscribe(this.pubsub_token),o.__super__.remove.apply(this,arguments)},o}(Backbone.View)}.call(this),function(){var t,e=function(t,e){function i(){this.constructor=t}for(var n in e)o.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;(t=Locomotive.Views.Inputs).Rte||(t.Rte={}),Locomotive.Views.Inputs.Rte.LinkView=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.isOpen=!1,o.prototype.container={dataset:{showdialogonselection:!0}},o.prototype.initialize=function(){return _.bindAll(this,"apply","show","hide"),this.$link=this.$("a[data-wysihtml5-command=createLink]"),this.editor=this.options.editor,this.$content=this.$link.next(".link-dialog-content")},o.prototype.render=function(){return this.attach_editor(),this.create_popover(),this.attach_events()},o.prototype.create_popover=function(){return this.$content.show(),this.$link.popover({container:".content",placement:"left",content:this.$content,html:!0,trigger:"manual",template:'<div class="popover" role="tooltip"><div class="arrow"></div><form class="simple_form"><div class="popover-content"></div></form></div>'}),this.$link.data("bs.popover").setContent()},o.prototype.attach_events=function(){return this.$content.on("click",".apply",this.apply),this.$content.on("click",".cancel",this.hide)},o.prototype.detach_events=function(){return this.$content.off("click",".apply",this.apply),this.$content.off("click",".cancel",this.hide)},o.prototype.attach_editor=function(){var t;return t=this.editor.toolbar.commandMapping["createLink:null"],t.dialog=this},o.prototype.apply=function(t){var e;return e=this._input_el("url").val(),_.isEmpty(e)?void 0:(this.editor.composer.commands.exec("createLink",{href:e,target:this._input_el("target","select").val(),title:this._input_el("title").val(),rel:"nofollow"}),this.editor.toolbar._preventInstantFocus(),this.hide())},o.prototype.show=function(t){var e;if(!this.isOpen||t===!1)return t===!1?this.$content.parents("form")[0].reset():(e=$(t),this._input_el("url").val(e.attr("href")),this._input_el("target","select").val(e.attr("target")),this._input_el("title").val(e.attr("title"))),this.$link.popover("toggle"),this._input_el("url").focus(),this.isOpen=!0},o.prototype.hide=function(){return this.$link.popover("hide"),this.isOpen=!1},o.prototype._input_el=function(t,e){var o;return e||(e="input"),o="rte_input_link_form["+t+"]",this.$content.find(e+'[name="'+o+'"]')},o.prototype.remove=function(){return this.detach_events(),this.$link.popover("destroy"),this.$(".popover").remove()},o}(Backbone.View)}.call(this),function(){var t,e=function(t,e){function i(){this.constructor=t}for(var n in e)o.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;(t=Locomotive.Views.Inputs).Rte||(t.Rte={}),Locomotive.Views.Inputs.Rte.TableView=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.container={dataset:[]},o.prototype.initialize=function(){return _.bindAll(this,"apply","show","hide","show_link","hide_link"),this.$link=this.$("a[data-wysihtml5-command=createTable]"),this.editor=this.options.editor,this.$content=this.$link.next(".table-dialog-content")},o.prototype.render=function(){return this.create_popover(),this.attach_events(),this.attach_editor()},o.prototype.create_popover=function(){return this.$content.show(),this.$link.popover({container:".main",placement:"left",content:this.$content,html:!0,trigger:"manual",template:'<div class="popover" role="tooltip"><div class="arrow"></div><form class="simple_form"><div class="popover-content"></div></form></div>'}),this.$link.data("bs.popover").setContent()},o.prototype.attach_events=function(){return this.$content.on("click",".apply",this.apply),this.$content.on("click",".cancel",this.hide),this.editor.on("tableselect:composer",this.hide_link),this.editor.on("tableunselect:composer",this.show_link)},o.prototype.detach_events=function(){return this.$content.off("click",".apply",this.apply),this.$content.off("click",".cancel",this.hide),this.editor.stopObserving("tableselect:composer",this.hide_link),this.editor.stopObserving("tableunselect:composer",this.show_link)},o.prototype.attach_editor=function(){var t;return t=this.editor.toolbar.commandMapping["createTable:null"],t.dialog=this},o.prototype.apply=function(t){return this.editor.composer.commands.exec("createTable",{cols:this._input_el("cols").val(),rows:this._input_el("rows").val(),class_name:this._input_el("class_name").val(),head:this._input_el("head").last().bootstrapSwitch("state")}),this.hide()},o.prototype.show=function(t){return this.$link.popover("toggle"),this.$content.parents("form")[0].reset()},o.prototype.hide=function(){return this.$link.popover("hide")},o.prototype.show_link=function(){return this.$link.show()},o.prototype.hide_link=function(){return this.$link.hide()},o.prototype._input_el=function(t,e){var o;return e||(e="input"),o="rte_input_table_form["+t+"]",this.$content.find(e+'[name="'+o+'"]')},o.prototype.remove=function(){return this.detach_events(),this.$link.popover("destroy"),this.$(".popover").remove()},o}(Backbone.View)}.call(this),function(){var t,e=function(t,e){function i(){this.constructor=t}for(var n in e)o.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;(t=Locomotive.Views).Inputs||(t.Inputs={}),Locomotive.Views.Inputs.RteView=function(t){
function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.events={"click a.style":"open_styles_dialog","click a.table":"open_table_dialog","click a.expand":"expand","highlight textarea":"highlight"},o.prototype.initialize=function(){return _.bindAll(this,"register_keydown_event","on_content_change","resize"),this.tokens=[PubSub.subscribe("application_view.resize",this.resize)],this.build_editor()},o.prototype.render=function(){return this.render_views()},o.prototype.build_editor=function(){var t;return t=this.$("textarea"),this.editor=new wysihtml5.Editor(t.attr("id"),{toolbar:"wysihtml5-toolbar-"+t.attr("id"),useLineBreaks:!1,parserRules:wysihtml5ParserRules,stylesheets:["/assets/locomotive/wysihtml5_editor-0763b0c32f99cebf5db8d2ba8bf8dc0e.css"]}),this.editor.on("load",this.register_keydown_event),this.editor.on("change",this.on_content_change),this.editor.on("aftercommand:composer",this.on_content_change)},o.prototype.render_views=function(){var t;return t=this,setTimeout(function(){return t.views=[t.build_and_render_view(Locomotive.Views.Inputs.Rte.LinkView),t.build_and_render_view(Locomotive.Views.Inputs.Rte.FileView),t.build_and_render_view(Locomotive.Views.Inputs.Rte.TableView),t.build_and_render_view(Locomotive.Views.Inputs.Rte.EditTableView)]},200)},o.prototype.expand=function(t){return t.stopPropagation()&t.preventDefault(),$(this.el).parents(".simple_form").toggleClass("rte-expanded"),$(this.el).parents(".inputs").toggleClass("expanded"),$(this.el).toggleClass("expanded"),null!=this.$style_popover&&this.$style_popover.popover("hide"),this.resize()},o.prototype.open_styles_dialog=function(t){var e,o;return e=$(t.target).closest("a"),o=e.next(".style-dialog-content").html(),this.$style_popover=this.$style_popover||e.popover({placement:"top",content:o,html:!0,title:void 0}),this.$style_popover.data("bs.popover").options.content=o,this.$style_popover.popover("show")},o.prototype.build_and_render_view=function(t,e){var o;return o=new t({el:this.el,editor:this.editor}),o.render(),o},o.prototype.register_keydown_event=function(){return this.$(".wysihtml5-sandbox").contents().find("body").on("keyup",function(t){return function(){return t.on_content_change()}}(this))},o.prototype.on_content_change=function(){return PubSub.publish("inputs.text_changed",{view:this,content:this.editor.getValue()})},o.prototype.highlight=function(t){return this.editor.focus()},o.prototype.resize=function(){var t,e,o,i,n,r;return t=this.$(".form-wrapper .wysihtml5-sandbox"),e=$(this.el).parents(".inputs"),o=this.$(".form-wrapper"),e.hasClass("expanded")?(i=o.outerHeight()-t.outerHeight(),r=$(this.el).height()-(o.outerHeight()-o.height()+parseInt(o.css("margin-top"))+parseInt($(this.el).css("padding-bottom"))),n=r-i,null==t.data("height")&&t.data("height",t.css("height")),t.css("min-height",n)):t.css("min-height",t.data("height"))},o.prototype.remove=function(){return _.invoke(this.views,"remove"),this.editor.stopObserving("onLoad",this.register_keydown_event),this.editor.stopObserving("onChange",this.on_content_change),_.each(this.tokens,function(t){return PubSub.unsubscribe(t)}),o.__super__.remove.call(this)},o}(Backbone.View)}.call(this),function(){var t,e=function(t,e){function i(){this.constructor=t}for(var n in e)o.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;(t=Locomotive.Views).Inputs||(t.Inputs={}),Locomotive.Views.Inputs.SimpleImageView=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.events={"click *[data-action=delete]":"mark_file_as_deleted","click *[data-action=undo]":"undo","change input[type=file]":"change_file"},o.prototype.render=function(){return this.$fields={file:this.$("input[type=file]"),remove:this.$("input[type=hidden].remove")},this.urls={"default":this.$(".file-wrapper").data("default-url"),current:this.$(".file-wrapper").data("url")},_.isEmpty(this.urls.current)&&(this.urls.current=this.urls["default"]),this.resize_format=this.$(".file-wrapper").data("resize"),this.no_file_label=this.$(".file-wrapper").data("no-file-label"),this.initial_state=null!=this.urls.current?"existing_file":"no_file"},o.prototype.mark_file_as_deleted=function(t){return"existing_file"===this.initial_state?(this.current_filename=this.$(".file-name").html(),this.update_ui(!1,!0,this.urls["default"],this.no_file_label)):void 0},o.prototype.undo=function(t){return this.update_ui(!0,!1,this.urls.current,this.current_filename||this.no_file_label)},o.prototype.change_file=function(t){var e;return e=t.target.files?t.target.files[0]:null,null!=e&&e.type.match("image.*")?(this.current_filename||(this.current_filename=this.$(".file-name").html()),this.image_to_base_64(e,function(t){return function(o){return window.resize_image(o,t.resize_format,function(o){return t.update_ui(!0,!0,o,e.name)})}}(this))):void 0},o.prototype.image_to_base_64=function(t,e){var o;return o=new FileReader,o.onload=function(t){return e(t.target.result)},o.readAsDataURL(t)},o.prototype.update_ui=function(t,e,o,i){var n;return n=t?"0":"1",this.$fields.remove.val(n),e?(this.$("*[data-action=delete]").hide(),this.$("*[data-action=undo]").show()):(this.$("*[data-action=undo]").hide(),this.$("*[data-action=delete]").show()),this.$(".file-image img").attr("src",o),_.isEmpty(i)?void 0:this.$(".file-name").html(i)},o}(Backbone.View)}.call(this),function(){var t,e=function(t,e){function i(){this.constructor=t}for(var n in e)o.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;(t=Locomotive.Views).Memberships||(t.Memberships={}),Locomotive.Views.Memberships.EditView=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.el=".main",o}(Locomotive.Views.Shared.FormView)}.call(this),function(){var t,e=function(t,e){function i(){this.constructor=t}for(var n in e)o.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;(t=Locomotive.Views).Memberships||(t.Memberships={}),Locomotive.Views.Memberships.NewView=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.el=".main",o}(Locomotive.Views.Shared.FormView)}.call(this),function(){var t,e=function(t,e){function i(){this.constructor=t}for(var n in e)o.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;(t=Locomotive.Views).MyAccount||(t.MyAccount={}),Locomotive.Views.MyAccount.EditView=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.el=".public-box",o.prototype.events={"click .api_key.input button":"regenerate_api_key","submit form":"save"},o.prototype.regenerate_api_key=function(t){var e;return t.stopPropagation()&t.preventDefault(),e=$(t.target),confirm(e.data("confirm"))?$.rails.ajax({url:e.data("url"),type:"put",dataType:"json",success:function(t){return function(t){return e.prev("code").html(t.api_key)}}(this)}):void 0},o}(Locomotive.Views.Shared.FormView)}.call(this),function(){var t,e=function(t,e){function i(){this.constructor=t}for(var n in e)o.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;(t=Locomotive.Views).Pages||(t.Pages={}),Locomotive.Views.Pages.FormView=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.el="#content",o.prototype.initialize=function(){return this.attach_events_on_redirect_attribute()},o.prototype.attach_events_on_redirect_attribute=function(){return this.$("#page_redirect").on("switchChange.bootstrapSwitch",function(t,e){var o;return o=$(".locomotive_page_redirect_url, .locomotive_page_redirect_type"),o.toggleClass("hide")})},o}(Locomotive.Views.Shared.FormView)}.call(this),function(){var t,e=function(t,e){function i(){this.constructor=t}for(var n in e)o.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;(t=Locomotive.Views).Pages||(t.Pages={}),Locomotive.Views.Pages.EditView=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.el=".main",o}(Locomotive.Views.Pages.FormView)}.call(this),function(){var t,e=function(t,e){function i(){this.constructor=t}for(var n in e)o.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;(t=Locomotive.Views).Pages||(t.Pages={}),Locomotive.Views.Pages.ListView=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.el=".pages-tree",o.prototype.render=function(){return this.make_foldable(),this.make_sortable(),this.make_hoverable(),this},o.prototype.make_foldable=function(){var t;return t=this,this.$("ul .fold-unfold").each(function(){var t,e;return e=$(this),t=e.next("ul.leaves"),e.hasClass("folded")?t.hide():void 0}).click(function(t){var e,o,i;return i=$(this),o=i.parents("li.node"),e=i.next("ul.leaves"),i.hasClass("folded")?e.slideDown("fast",function(){return i.removeClass("folded").addClass("unfolded"),$.cookie(o.attr("id"),"unfolded",{path:window.Locomotive.mounted_on})}):e.slideUp("fast",function(){return i.removeClass("unfolded").addClass("folded"),$.cookie(o.attr("id"),"folded",{path:window.Locomotive.mounted_on})})})},o.prototype.make_sortable=function(){var t;return t=this,this.$("ul").sortable({items:"> li.page",handle:".draggable",axis:"y",placeholder:"sortable-placeholder",cursor:"move",update:function(e,o){return t.call_sort($(this))},stop:function(t,e){var o;return $(this).hasClass("root")&&(o=e.item.index(),0===o||o>=$(this).find("> li").size()-2)?$(this).sortable("cancel"):void 0}})},o.prototype.make_hoverable=function(){return this.$("a").hover(function(){return $(this).prev("i.icon").addClass("on")},function(){return $(this).prev("i.icon").removeClass("on")})},o.prototype.call_sort=function(t){return $.rails.ajax({url:t.data("url"),type:"post",dataType:"json",data:{children:_.map(t.sortable("toArray"),function(t){return t.replace("node-","")}),_method:"put"},success:this.on_successful_sort,error:this.on_failed_sort})},o.prototype.on_successful_sort=function(t,e,o){return Locomotive.notify(decodeURIComponent($.parseJSON(o.getResponseHeader("X-Message"))),"success"),PubSub.publish("pages.sorted")},o.prototype.on_failed_sort=function(t,e,o){return Locomotive.notify(decodeURIComponent($.parseJSON(o.getResponseHeader("X-Message"))),"error")},o}(Backbone.View)}.call(this),function(){var t,e=function(t,e){function i(){this.constructor=t}for(var n in e)o.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;(t=Locomotive.Views).Pages||(t.Pages={}),Locomotive.Views.Pages.NewView=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.el=".main",o}(Locomotive.Views.Pages.FormView)}.call(this),function(){var t,e=function(t,e){function i(){this.constructor=t}for(var n in e)o.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;(t=Locomotive.Views).PublicSubmissionAccounts||(t.PublicSubmissionAccounts={}),Locomotive.Views.PublicSubmissionAccounts.EditView=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.el=".main",o}(Locomotive.Views.Shared.FormView)}.call(this),function(){var t,e=function(t,e){function i(){this.constructor=t}for(var n in e)o.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;(t=Locomotive.Views).Shared||(t.Shared={}),Locomotive.Views.Shared.DrawerView=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.el="section.drawer",o.prototype.delays={fade:50,remove:200},o.prototype.events={"click .close-button":"close"},o.prototype.initialize=function(){return this.stack=[],o.__super__.initialize.apply(this,arguments)},o.prototype.open=function(t,e,o){var i;return null==o&&(o={}),console.log("[DrawerView] open, stack("+this.stack.length+") opened = "+$("body").hasClass("drawer-opened")+", "+t),i={url:t,view_klass:e,options:o},this.push(i)},o.prototype.close=function(){return console.log("[DrawerView] close, stack("+this.stack.length+")"),this.pop()},o.prototype.push=function(t){return this.hide(this.last_entry()),this.stack.push(t),this.show(t)},o.prototype.pop=function(){var t;return t=this.stack.pop(),this.hide(t,function(t){return function(){return t.show(t.last_entry())}}(this))},o.prototype.replace=function(t){var e,o;return o=this.stack.pop(),e=this.container(!0),this.stack.push(t),null!=t.url?e.load(t.url,function(i){return function(){return o&&o.view.remove(),i._show(t,e)}}(this)):this._show(t,e)},o.prototype.show=function(t){var e;if(null!==t)return e=1===this.stack.length?0:this.delays.fade,setTimeout(function(e){return function(){var o;return o=e.container(),null!=t.url?o.load(t.url,function(){return e._show(t,o)}):e._show(t,o)}}(this),e)},o.prototype.hide=function(t,e){return 0===this.stack.length?$("body").removeClass("drawer-opened"):null!=t&&t.view.$el.addClass("fadeout"),setTimeout(function(o){return function(){return null!=t&&(null!=t.view.hide_from_drawer&&t.view.hide_from_drawer(o.stack.length),t.view.remove()),null!=e?e():void 0}}(this),this.delays.remove)},o.prototype.last_entry=function(){return 0===this.stack.length?null:this.stack[this.stack.length-1]},o.prototype.container=function(t){return null!=t&&t?this.$("> .inner").find("> div"):this.$("> .inner").html("<div></div>").find("> div")},o.prototype._show=function(t,e){var o,i;return o=t.view_klass,i=_.extend({el:e,drawer:this},t.options),t.view=new o(i),t.view.render(),$("body").addClass("drawer-opened")},o}(Backbone.View)}.call(this),function(){var t,e=function(t,e){function i(){this.constructor=t}for(var n in e)o.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;(t=Locomotive.Views).Shared||(t.Shared={}),Locomotive.Views.Shared.HeaderView=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.el=".header",o.prototype.initialize=function(){},o.prototype.render=function(){},o.prototype.height=function(){return $(this.el).outerHeight(!0)},o}(Backbone.View)}.call(this),function(){var t,e=function(t,e){function i(){this.constructor=t}for(var n in e)o.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;(t=Locomotive.Views).Shared||(t.Shared={}),Locomotive.Views.Shared.ListItemView=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.tagName="li",o.prototype.events={"click a.remove":"remove_item"},o.prototype.template=function(){},o.prototype.render=function(){return $(this.el).html(this.template()(this.model.toJSON())),this},o.prototype.remove_item=function(t){return t.stopPropagation()&t.preventDefault(),confirm($(t.target).closest("a").data("confirm"))?this.model.destroy():void 0},o}(Backbone.View)}.call(this),function(){var t,e=function(t,e){function i(){this.constructor=t}for(var n in e)o.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;(t=Locomotive.Views).Shared||(t.Shared={}),Locomotive.Views.Shared.ListView=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.initialize=function(){return this.sort_url=$(this.el).data("sort-url")},o.prototype.render=function(){return null!=this.sort_url?this.make_sortable():void 0},o.prototype.make_sortable=function(){var t;return t=this,$(this.el).sortable({items:"> .item",handle:".draggable",axis:"y",placeholder:"sortable-placeholder",cursor:"move",start:function(t,e){return e.placeholder.html('<div class="inner">&nbsp;</div>')},update:function(e,o){return t.call_sort(o)}})},o.prototype.call_sort=function(){return $.rails.ajax({url:this.sort_url,type:"post",dataType:"json",data:{entries:_.map($(this.el).find("> .item"),function(t){return $(t).data("id")}),_method:"put"},success:this.on_successful_sort,error:this.on_failed_sort})},o.prototype.on_successful_sort=function(t,e,o){var i;return i=o.getResponseHeader("X-Message"),Locomotive.notify(decodeURIComponent($.parseJSON(i)),"success")},o.prototype.on_failed_sort=function(t,e,o){var i;return i=_.isObject(o)?$.parseJSON(o.getResponseHeader("X-Message")):o,Locomotive.notify(decodeURIComponent(i),"danger")},o}(Backbone.View)}.call(this),function(){var t,e=function(t,e){function i(){this.constructor=t}for(var n in e)o.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;(t=Locomotive.Views).Shared||(t.Shared={}),Locomotive.Views.Shared.SidebarView=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.el="nav.sidebar",o.prototype.initialize=function(){return this.pages_view=new Locomotive.Views.Pages.ListView},o.prototype.render=function(){return this.pages_view.render()},o}(Backbone.View)}.call(this),function(){var t,e=function(t,e){function i(){this.constructor=t}for(var n in e)o.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;(t=Locomotive.Views).Sites||(t.Sites={}),Locomotive.Views.Sites.NewView=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o}(Locomotive.Views.Shared.FormView)}.call(this),function(){var t,e=function(t,e){function i(){this.constructor=t}for(var n in e)o.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},o={}.hasOwnProperty;(t=Locomotive.Views).Translations||(t.Translations={}),Locomotive.Views.Translations.IndexView=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return e(o,t),o.prototype.el=".main",o}(Backbone.View)}.call(this);